<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <title>ë‚´ ìœ„ì¹˜ ì°¾ê¸° ê°œì„  ì§€ë„</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    #map {
      width: 100%;
      height: 100vh;
    }

    .button {
      position: absolute;
      top: 10px;
      left: 10px;
      z-index: 10;
      background: white;
      padding: 10px;
      border-radius: 8px;
      box-shadow: 0 0 5px rgba(0,0,0,0.3);
      cursor: pointer;
    }
  </style>
  <script defer src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=abf50f881fbafdf6787347059a09b69c&autoload=false"></script>
  <script>
    let map;
    let myLocationMarker = null;

    window.onload = function () {
      kakao.maps.load(function () {
        const container = document.getElementById('map');
        const options = {
          center: new kakao.maps.LatLng(37.5665, 126.9780), // ì´ˆê¸° ìœ„ì¹˜ (ì„œìš¸)
          level: 5
        };
        map = new kakao.maps.Map(container, options);
        // âœ… ì—¬ê¸°ì— ê¸°ì¡´ ë§ˆì»¤ ë“±ë¡ ì½”ë“œ ë„£ê¸°
      });
    };

    function findMyLocation() {
      if (!navigator.geolocation) {
        alert("ì´ ë¸Œë¼ìš°ì €ì—ì„œëŠ” ìœ„ì¹˜ ì •ë³´ê°€ ì§€ì›ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
        return;
      }

      navigator.geolocation.getCurrentPosition(
        function (position) {
          const lat = position.coords.latitude;
          const lng = position.coords.longitude;
          const accuracy = position.coords.accuracy;

          console.log("ğŸ“ ìœ„ë„: " + lat);
          console.log("ğŸ“ ê²½ë„: " + lng);
          console.log("ğŸ“ ì •í™•ë„: " + accuracy + "m");

          const locPosition = new kakao.maps.LatLng(lat, lng);

          if (myLocationMarker) {
            myLocationMarker.setMap(null);
          }

          const marker = new kakao.maps.Marker({
            position: locPosition,
            image: new kakao.maps.MarkerImage(
              "https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/marker_red.png",
              new kakao.maps.Size(30, 45)
            )
          });
          marker.setMap(map);
          myLocationMarker = marker;

          map.setLevel(3);
          map.panTo(locPosition);
        },
        function (error) {
          console.error("ìœ„ì¹˜ ì •ë³´ ì˜¤ë¥˜:", error);
          switch (error.code) {
            case error.PERMISSION_DENIED:
              alert("ìœ„ì¹˜ ì ‘ê·¼ì´ ì°¨ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤. ë¸Œë¼ìš°ì € ìœ„ì¹˜ ê¶Œí•œì„ í™•ì¸í•˜ì„¸ìš”.");
              break;
            case error.POSITION_UNAVAILABLE:
              alert("ìœ„ì¹˜ ì •ë³´ë¥¼ í™•ì¸í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
              break;
            case error.TIMEOUT:
              alert("ìœ„ì¹˜ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ” ë° ì‹œê°„ì´ ì´ˆê³¼ë˜ì—ˆìŠµë‹ˆë‹¤.");
              break;
            default:
              alert("ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
          }
        },
        {
          enableHighAccuracy: true,
          timeout: 10000,
          maximumAge: 0
        }
      );
    }
  </script>
</head>
<body>
  <div class="button" onclick="findMyLocation()">ğŸ“ ë‚´ ìœ„ì¹˜ ì°¾ê¸°</div>
  <div id="map"></div>
</body>
</html>
