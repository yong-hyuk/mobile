<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8">
  <title>ëª¨ë°”ì¼ ìµœì í™” ì§€ë„</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=abf50f881fbafdf6787347059a09b69c&autoload=true"></script>
  <style>
    html, body { height: 100%; margin: 0; padding: 0; overflow: hidden; }
    #map { width: 100%; height: 100%; }
    #locateBtn {
      position: absolute;
      bottom: 20px;
      right: 20px;
      z-index: 10;
      padding: 10px 15px;
      background-color: #007bff;
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 14px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.3);
    }
  </style>
</head>
<body>
  <div id="map"></div>
  <button id="locateBtn" onclick="goToMyLocation()">ë‚´ ìœ„ì¹˜</button>

  <script>
    let map, myLocation;
    const completed = {};

    const markerData = [
{ lat 37.3241820391565, lng 129.263671429562, title ì˜ë‚¨ ë™í•´ì„ 17-1(í¬ì‚¼)_ê°•ì›ë„ ì‚¼ì²™ì‹œ ê·¼ë•ë©´ ê¶ì´Œë¦¬ ì‚°76-7 },
{ lat 37.3389729, lng 129.2454184, title ì˜ë‚¨ ë™í•´ì„ 17-2(í¬ì‚¼)_ê°•ì›ë„ ì‚¼ì²™ì‹œ ê·¼ë•ë©´ ë™ë§‰ë¦¬ ì‚° 88 },
{ lat 37.3449888971359, lng 129.237951875139, title ì˜ë‚¨ ë™í•´ì„ 17-3(í¬ì‚¼)_ê°•ì›ë„ ì‚¼ì²™ì‹œ ê·¼ë•ë©´ ë™ë§‰ë¦¬ ì‚°587-4 },
{ lat 37.34827362, lng 129.2357483, title ì˜ë‚¨ ë™í•´ì„ 17-4(í¬ì‚¼)_ê°•ì›ë„ ì‚¼ì²™ì‹œ ê·¼ë•ë©´ ë™ë§‰ë¦¬ 915-1 },
{ lat 37.349107624683, lng 129.233299468898, title ì˜ë‚¨ ë™í•´ì„ 17-5(í¬ì‚¼)_ê°•ì›ë„ ì‚¼ì²™ì‹œ ê·¼ë•ë©´ ê´‘íƒœë¦¬ ì‚°159-3 },
{ lat 37.35428643, lng 129.2279111, title ì˜ë‚¨ ë™í•´ì„ 17-6(í¬ì‚¼)_ê°•ì›ë„ ì‚¼ì²™ì‹œ ê·¼ë•ë©´ ê´‘íƒœë¦¬ 273-1 },
{ lat 37.3832942582047, lng 129.216012976991, title ì˜ë‚¨ ë™í•´ì„ 17-7(í¬ì‚¼)_ê°•ì›ë„ ì‚¼ì²™ì‹œ ê·¼ë•ë©´ í•˜ë§¹ë°©ë¦¬ ì‚° 186 },
{ lat 37.38816375, lng 129.2124715, title ì˜ë‚¨ ë™í•´ì„ 17-8(í¬ì‚¼)_ê°•ì›ë„ ì‚¼ì²™ì‹œ ê·¼ë•ë©´ í•˜ë§¹ë°©ë¦¬ ì‚° 38 },
{ lat 37.39103703, lng 129.2107839, title ì˜ë‚¨ ë™í•´ì„ 17-9(í¬ì‚¼)_ê°•ì›ë„ ì‚¼ì²™ì‹œ ê·¼ë•ë©´ ìƒë§¹ë°©ë¦¬ ì‚° 113 },
{ lat 37.3963922, lng 129.2081888, title ì˜ë‚¨ ë™í•´ì„ 17-10(í¬ì‚¼)_ê°•ì›ë„ ì‚¼ì²™ì‹œ ê·¼ë•ë©´ ìƒë§¹ë°©ë¦¬ ì‚° 98 },
{ lat 37.4008775980085, lng 129.204955550579, title ì˜ë‚¨ ë™í•´ì„ 17-11(í¬ì‚¼)_ê°•ì›ë„ ì‚¼ì²™ì‹œ ê·¼ë•ë©´ ìƒë§¹ë°©ë¦¬ ì‚°75-1 },
{ lat 37.43100852, lng 129.1741177, title ì˜ë‚¨ ë™í•´ì„ 17-12(í¬ì‚¼)_ê°•ì›ë„ ì‚¼ì²™ì‹œ ì‚¬ì§ë™ 216-24 }
    ];

    kakao.maps.load(() => {
      map = new kakao.maps.Map(document.getElementById('map'), {
        center: new kakao.maps.LatLng(markerData[0].lat, markerData[0].lng),
        level: 8
      });

      map.setMapTypeId(kakao.maps.MapTypeId.SKYVIEW);

      const bounds = new kakao.maps.LatLngBounds();
      const markers = [];

      markerData.forEach((data, idx) => {
        const pos = new kakao.maps.LatLng(data.lat, data.lng);
        const marker = new kakao.maps.Marker({
          position: pos,
          title: data.title,
          map: map,
          image: createMarkerImage(false)
        });

        marker.idx = idx;

        const infowindow = new kakao.maps.InfoWindow({
          content: `
            <div style="padding:5px;font-size:13px;">
              ${data.title}<br/>
              <label><input type="checkbox" onclick="markComplete(${idx}, this)"> ì™„ë£Œ</label>
            </div>
          `
        });

        kakao.maps.event.addListener(marker, 'click', () => {
          infowindow.open(map, marker);
        });

        markers.push(marker);
        bounds.extend(pos);
      });

      map.setBounds(bounds);
      window.markers = markers;
    });

    function createMarkerImage(isComplete) {
      const imageSrc = isComplete
        ? "http://t1.daumcdn.net/localimg/localimages/07/mapapidoc/marker_green.png"
        : "http://t1.daumcdn.net/localimg/localimages/07/mapapidoc/marker_red.png";
      return new kakao.maps.MarkerImage(imageSrc, new kakao.maps.Size(24, 35));
    }

    function markComplete(idx, checkbox) {
      if (!checkbox.checked) return;
      completed[idx] = true;
      markers[idx].setImage(createMarkerImage(true));
      moveToNextIncomplete();
    }

    function moveToNextIncomplete() {
      for (let i = 0; i < markers.length; i++) {
        if (!completed[i]) {
          map.panTo(markers[i].getPosition());
          return;
        }
      }
      alert("ğŸ‰ ëª¨ë“  ì§€ì ì„ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤!");
    }

    function goToMyLocation() {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(pos => {
          myLocation = new kakao.maps.LatLng(pos.coords.latitude, pos.coords.longitude);
          map.setCenter(myLocation);
        }, () => {
          alert("ìœ„ì¹˜ ì •ë³´ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
        });
      } else {
        alert("ì´ ë¸Œë¼ìš°ì €ëŠ” ìœ„ì¹˜ ì •ë³´ë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
      }
    }
  </script>
</body>
</html>
